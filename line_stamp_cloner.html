<!DOCTYPE html>
<html lang="ja">
<head>
Â  Â  <title>Line Stamp Cloner</title>
Â  Â  <meta charset="utf-8">
Â  Â  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
Â  Â  <meta http-equiv="Pragma" content="no-cache" />
Â  Â  <meta http-equiv="Expires" content="0" />
Â  Â  <meta http-equiv="X-UA-Compatible" content="IE=edge">
Â  Â  <meta name="viewport" content="width=device-width initial-scale=1, viewport-fit=cover"/>
Â  Â  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
Â  Â  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
Â  Â  <link rel="stylesheet" href="style.css" />
</head>
<body>
    <h1 class="title">Line Stamp Cloner</h1>
    <div id="informations">
        <div class="information">
            <div class="window">
                <h1>Clone</h1>
                <h3 id="result" style="display:none;"></h3><br>
                <input type="text" placeholder="TOKEN" id="token"><br>
                <input type="text" placeholder="ServerID" id="server_id"><br>
                <input type="text" placeholder="URL" id="url"><br>
                <button class="basic_button" onclick="clone()">Copy</button>
            </div>
        </div>
    </div>
Â  Â  <button class="change_theme" onclick="change_theme()">ğŸ”¦</button>

Â  Â  <script>
        function sleep(ms) {return new Promise(resolve => setTimeout(resolve, ms));}
        
        async function get_data(blob) {return new Promise((resolve, reject) => {const reader = new FileReader();reader.onload = () => resolve(reader.result);reader.onerror = reject;reader.readAsDataURL(blob);});}

Â  Â  Â  Â  async function clone_pic(token,server_id,name,url) {
Â  Â  Â  Â  Â  Â  const response = await fetch(url);
Â  Â  Â  Â  Â  Â  if (!response.ok) throw new Error("Error");
            const blob = await response.blob();
            const data = await get_data(blob);
            const res = await fetch(`https://discord.com/api/v9/guilds/${server_id}/emojis`, { method: "POST", headers: { "authorization": token, "content-type": "application/json"}, body: JSON.stringify({ image: data, name: name })});
            const res_data = await res.json();
            if (!res_data.available){console.warn("Fail")};
Â  Â  Â  Â  }

Â  Â  Â  Â  async function clone() {
Â  Â  Â  Â  Â  Â  const urlInput = document.getElementById('url').value.trim();
Â  Â  Â  Â  Â  Â  const token = document.getElementById('token').value.trim();
Â  Â  Â  Â  Â  Â  const server_id = document.getElementById('server_id').value.trim();
Â  Â  Â  Â  Â  Â  const id = urlInput.split("/")[5];
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await axios.get(`https://stickershop.line-scdn.net/products/0/0/1/${id}/iphone/productInfo.meta`);
Â  Â  Â  Â  Â  Â  Â  Â  const stickers = response.data.stickers;
                const package_name = response.data.title.en;
Â  Â  Â  Â  Â  Â  Â  Â  for (const sticker of stickers) {
                    const s_id = sticker.id;
                    const imageUrl = `https://stickershop.line-scdn.net/stickershop/v1/sticker/${s_id}/iphone/sticker@2x.png`;
                    await clone_pic(token, server_id, s_id, imageUrl);
                    await sleep(300);
                }
Â  Â  Â  Â  Â  Â  Â  Â  const link = document.getElementById('result');
Â  Â  Â  Â  Â  Â  Â  Â  link.textContent = "ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸ";
Â  Â  Â  Â  Â  Â  Â  Â  link.style.display = 'inline';
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.warn(error);
Â  Â  Â  Â  Â  Â  Â  Â  alert("ã‚¹ã‚¿ãƒ³ãƒ—æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
        
        $(function(){
            const theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? "dark" : "light";
            const html = document.documentElement;
            html.setAttribute('data-theme', theme);
        });
        
Â  Â  Â  Â  function change_theme() {
Â  Â  Â  Â  Â  Â  const html = document.documentElement;
Â  Â  Â  Â  Â  Â  const theme = html.getAttribute('data-theme');
Â  Â  Â  Â  Â  Â  const to_theme = theme === 'light' ? 'dark' : 'light';
Â  Â  Â  Â  Â  Â  html.setAttribute('data-theme', to_theme);
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
